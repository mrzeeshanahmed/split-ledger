
[7m[1m[36m RUN [39m[22m[27m [36mv1.6.1[39m [90mD:/split_ledger/backend[39m

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuth Flow Integration Tests[2m > [22m[2mRegister Î“Ã¥Ã† login Î“Ã¥Ã† get /auth/me Î“Ã¥Ã† logout Î“Ã¥Ã† verify token invalidated[22m[39m
Tables cloned from tenant_template: [
  { table_name: [32m'users'[39m },
  { table_name: [32m'api_keys'[39m },
  { table_name: [32m'api_key_usage'[39m },
  { table_name: [32m'usage_records'[39m },
  { table_name: [32m'webhooks'[39m },
  { table_name: [32m'webhook_deliveries'[39m }
]

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuth Flow Integration Tests[2m > [22m[2mRefresh token flow: using a valid refresh token generates a new access token[22m[39m
Tables cloned from tenant_template: [
  { table_name: [32m'users'[39m },
  { table_name: [32m'api_keys'[39m },
  { table_name: [32m'api_key_usage'[39m },
  { table_name: [32m'usage_records'[39m },
  { table_name: [32m'webhooks'[39m },
  { table_name: [32m'webhook_deliveries'[39m }
]

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuth Flow Integration Tests[2m > [22m[2mPassword reset: forgot Î“Ã¥Ã† reset Î“Ã¥Ã† login with new password[22m[39m
Tables cloned from tenant_template: [
  { table_name: [32m'users'[39m },
  { table_name: [32m'api_keys'[39m },
  { table_name: [32m'api_key_usage'[39m },
  { table_name: [32m'usage_records'[39m },
  { table_name: [32m'webhooks'[39m },
  { table_name: [32m'webhook_deliveries'[39m }
]

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuth Flow Integration Tests[2m > [22m[2mPassword reset: forgot Î“Ã¥Ã† reset Î“Ã¥Ã† login with new password[22m[39m
<empty line>
stderr | tests/integration/auth.test.ts > Auth Flow Integration Tests > Password reset: forgot Î“Ã¥Ã† reset Î“Ã¥Ã† login with new password
reset failed in auth: {
  error: {
    code: 'VALIDATION_ERROR',
    message: 'Validation failed',
    details: [ [Object] ]
  }
}

[90mstdout[2m | tests/integration/auth.test.ts[2m > [22m[2mAuth Flow Integration Tests[2m > [22m[2mRate limit: 11th login attempt within 15 min returns 429[22m[39m
Tables cloned from tenant_template: [
  { table_name: [32m'users'[39m },
  { table_name: [32m'api_keys'[39m },
  { table_name: [32m'api_key_usage'[39m },
  { table_name: [32m'usage_records'[39m },
  { table_name: [32m'webhooks'[39m },
  { table_name: [32m'webhook_deliveries'[39m }
]

 [33mÎ“Â¥Â»[39m tests/integration/auth.test.ts [2m ([22m[2m4 tests[22m [2m|[22m [31m2 failed[39m[2m)[22m[33m 3792[2mms[22m[39m
[31m   [33mÎ“Â¥Â»[31m tests/integration/auth.test.ts[2m > [22mAuth Flow Integration Tests[2m > [22mRegister Î“Ã¥Ã† login Î“Ã¥Ã† get /auth/me Î“Ã¥Ã† logout Î“Ã¥Ã† verify token invalidated[39m
[31m     Î“Ã¥Ã† expected 200 to be 401 // Object.is equality[39m
[31m   [33mÎ“Â¥Â»[31m tests/integration/auth.test.ts[2m > [22mAuth Flow Integration Tests[2m > [22mPassword reset: forgot Î“Ã¥Ã† reset Î“Ã¥Ã† login with new password[39m
[31m     Î“Ã¥Ã† expected 400 to be 200 // Object.is equality[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 2 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  tests/integration/auth.test.ts > Auth Flow Integration Tests > Register Î“Ã¥Ã† login Î“Ã¥Ã† get /auth/me Î“Ã¥Ã† logout Î“Ã¥Ã† verify token invalidated
AssertionError: expected 200 to be 401 // Object.is equality

- Expected
+ Received

- 401
+ 200

 Î“Â¥Â» tests/integration/auth.test.ts:124:35
    122|             .set('Cookie', cookies);
    123| 
    124|         expect(resMeAfter.status).toBe(401);
       |                                   ^
    125|     });
    126| 

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/2]Î“Ã„Â»

 FAIL  tests/integration/auth.test.ts > Auth Flow Integration Tests > Password reset: forgot Î“Ã¥Ã† reset Î“Ã¥Ã† login with new password
AssertionError: expected 400 to be 200 // Object.is equality

- Expected
+ Received

- 200
+ 400

 Î“Â¥Â» tests/integration/auth.test.ts:220:33
    218|         }
    219| 
    220|         expect(resReset.status).toBe(200);
       |                                 ^
    221| 
    222|         // Try loggin in with new password

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/2]Î“Ã„Â»

[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m2 passed[39m[22m[90m (4)[39m
[2m   Start at [22m 16:50:58
[2m   Duration [22m 5.25s[2m (transform 365ms, setup 115ms, collect 1.05s, tests 3.79s, environment 0ms, prepare 117ms)[22m

